# ========================================
# Nacos Bootstrap Configuration
# ========================================
# 此配置文件在Spring Boot应用启动的最早期加载,用于初始化Nacos服务发现和配置中心连接。
# 优先级: bootstrap.yml > application.yml
#
# 关键特性:
# - 支持环境变量覆盖(便于Docker/K8s部署)
# - Jasypt加密支持(保护敏感信息)
# - 动态配置刷新(@RefreshScope)
# - 多环境共享配置(shared-configs)
# ========================================

spring:
  application:
    name: basebackend-scheduler

  profiles:
    active: ${SPRING_PROFILES_ACTIVE:dev}

  cloud:
    nacos:
      discovery:
        server-addr: ${NACOS_SERVER:192.168.66.126:8848}
        namespace: ${NACOS_NAMESPACE:public}
        group: ${NACOS_GROUP:DEFAULT_GROUP}
        username: ${NACOS_USERNAME:nacos}
        password: ${NACOS_PASSWORD:nacos}
      config:
        server-addr: ${NACOS_SERVER:192.168.66.126:8848}
        namespace: ${NACOS_NAMESPACE:public}
        group: ${NACOS_GROUP:DEFAULT_GROUP}
        username: ${NACOS_USERNAME:nacos}
        password: ${NACOS_PASSWORD:nacos}
        file-extension: yml
        # Scheduler 专用配置优先级最高
        extension-configs:
          - data-id: ${spring.application.name}-${spring.profiles.active}.yml
            group: ${NACOS_GROUP:DEFAULT_GROUP}
            refresh: true

# ========================================
# Jasypt加密配置
# ========================================
# 用于加密敏感配置(如数据库密码、API密钥等)
# 使用方式: ENC(加密后的密文)
#
# 加密命令示例:
# java -cp jasypt-1.9.3.jar org.jasypt.intf.cli.JasyptPBEStringEncryptionCLI \
#   input="原文" \
#   password="密钥" \
#   algorithm="PBEWITHHMACSHA512ANDAES_256"
#
# 注意事项:
# 1. 生产环境必须通过环境变量传入密钥,严禁硬编码
# 2. 密钥长度建议16位以上,包含字母、数字、特殊字符
# 3. 定期轮换密钥,提高安全性
jasypt:
  encryptor:
    # 加密密钥: 生产环境必须通过环境变量传入
    password: ${JASYPT_ENCRYPTOR_PASSWORD:change-me-in-production}

    # 加密算法: PBEWITHHMACSHA512ANDAES_256(强度高,推荐)
    algorithm: PBEWITHHMACSHA512ANDAES_256

    # IV生成器: 使用随机IV增强安全性
    iv-generator-classname: org.jasypt.iv.RandomIvGenerator