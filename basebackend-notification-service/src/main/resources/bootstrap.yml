spring:
  application:
    name: basebackend-notification-service
  profiles:
    active: ${SPRING_PROFILES_ACTIVE:dev}

    # ========== Spring Cloud 集成配置 ==========
  cloud:
    nacos:
      discovery:
        server-addr: ${nacos.discovery.server-addr}
        namespace: ${nacos.discovery.namespace}
        group: ${nacos.discovery.group}
        username: ${NACOS_CONFIG_USERNAME:nacos}
        password: ${NACOS_CONFIG_PASSWORD:nacos}
        metadata:
          # 传递实例元数据
          version: ${nacos.discovery.metadata.version}
          region: ${nacos.discovery.metadata.region}
          zone: ${nacos.discovery.metadata.zone}
          weight: ${nacos.discovery.weight}
      config:
        server-addr: ${nacos.config.server-addr}
        namespace: ${nacos.config.namespace}
        group: ${nacos.config.group}
        username: ${NACOS_CONFIG_USERNAME:nacos}
        password: ${NACOS_CONFIG_PASSWORD:nacos}
        file-extension: ${nacos.config.file-extension}
        shared-configs:
          - data-id: common-config.yml
            refresh: true
          - data-id: mysql-config.yml
            refresh: true
          - data-id: observability-config.yml
            refresh: true
          - data-id: redis-config.yml
            refresh: true
          - data-id: rocketmq-config.yml
            refresh: true
          - data-id: seata-config.yml
            refresh: true
          - data-id: backup-config.yml
            refresh: true
          - data-id: security-config.yml
            refresh: true
          - data-id: application-web-config.yml
            refresh: true
        # 扩展配置（网关特有配置）
        extension-configs:
          - data-id: ${spring.application.name}-${spring.profiles.active}.yml
            group: ${NACOS_GROUP:DEFAULT_GROUP}
            refresh: true

nacos:
  enabled: true
  # 环境名称（用于环境隔离）
  environment: ${spring.profiles.active:dev}
  # 租户ID（用于租户隔离）
  tenant-id: public

  # 应用ID（用于应用隔离）
  app-id: 10001
  config:
    enabled: true
    # Nacos 服务地址（关键配置，启动时必验证）
    server-addr: ${NACOS_CONFIG_SERVER:192.168.66.126:8848}
    namespace: ${NACOS_CONFIG_NAMESPACE:public}
    group: ${NACOS_CONFIG_GROUP:DEFAULT_GROUP}
    file-extension: ${NACOS_CONFIG_FILE_EXTENSION:yml}
    # 用户名密码
    username: ${NACOS_CONFIG_USERNAME:nacos}
    password: ${NACOS_CONFIG_PASSWORD:nacos}
    # 是否启用导入检查
    #    import-check-enabled: true
    # 动态刷新配置（自动检测是否启用）
    # 如果配置了shared-configs或extension-configs，将自动启用
    refresh-enabled: ${NACOS_CONFIG_REFRESH_ENABLED:true}
    shared-configs:
      - data-id: common-config.yml
        refresh: true
      - data-id: mysql-config.yml
        refresh: true
      - data-id: observability-config.yml
        refresh: true
      - data-id: redis-config.yml
        refresh: true
      - data-id: rocketmq-config.yml
        refresh: true
      - data-id: seata-config.yml
        refresh: true
      - data-id: backup-config.yml
        refresh: true
      - data-id: security-config.yml
        refresh: true
      - data-id: application-web-config.yml
        refresh: true
    # 扩展配置（网关特有配置）
    extension-configs:
      - data-id: ${spring.application.name}-${spring.profiles.active}.yml
        group: ${NACOS_GROUP:DEFAULT_GROUP}
        refresh: true

  # ========== 服务发现配置 ==========
  discovery:
    enabled: true  # 是否启用服务发现

    # Nacos 服务地址（关键配置，启动时必验证）
    server-addr: ${NACOS_DISCOVERY_SERVER:192.168.66.126:8848}
    namespace: ${NACOS_DISCOVERY_NAMESPACE:public}
    group: ${NACOS_DISCOVERY_GROUP:DEFAULT_GROUP}
    weight: ${NACOS_DISCOVERY_WEIGHT:1.0}
    cluster: ${NACOS_DISCOVERY_CLUSTER:DEFAULT}

    # 服务名（可选，如果不配置则使用spring.application.name）
    service-name: ${spring.application.name}

    # 用户名密码
    username: ${NACOS_DISCOVERY_USERNAME:nacos}
    password: ${NACOS_DISCOVERY_PASSWORD:nacos}

    # 实例元数据（用于灰度发布）
    metadata:
      version: ${APP_VERSION:1.0.0}
      region: ${APP_REGION:beijing}
      zone: ${APP_ZONE:zone-a}